function [y1] = fj_friskis_final(x1)
%FJ_FRISKIS_FINAL neural network simulation function.
%
% Auto-generated by MATLAB, 08-May-2019 22:30:54.
% 
% [y1] = fj_friskis_final(x1) takes these arguments:
%   x = 4xQ matrix, input #1
% With 
%   Row 1: Outdoor temperature in Celsius
%   Row 2: Month [1-12]
%   Row 3: Workday or non-workday [1 = workday, 0 = non-workday] 
%   Row 4: Time of day [1-24, with 24 = 00 is treated as the start of the
%          year, i.e., the first hour of the year has value 24. This since
%          the logged value for that time is primarly between 23 -24 the
%          day before]
% and returns:
%   y = 1xQ matrix, output #1
% where Q is the number of samples.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-12.5;2;0;1];
x1_step1.gain = [0.0436681222707424;0.25;2;0.0869565217391304];
x1_step1.ymin = -1;

% Layer 1
b1 = [4.3879978100993115575;4.3339886926532997791;3.4147436888106690311;-4.6239656282853482949;-5.0222596855737453581;-4.8325630252471283299;3.7556242956463909977;-3.9011684446880159349;3.1341585370247426745;3.2778601520416446036;3.0923579020191538369;3.4852111192579693366;-2.8229935688845788633;-1.8493718114811628084;2.4944630341556930375;-2.0395047217022930219;2.1946680454047191589;-2.206274671978575963;1.8407617019375559497;2.5874545711711460783;-3.4569872758335558061;2.6479201265558547362;2.4010271376969045676;-1.5201405329677295519;1.4137973020236149768;0.89397629013089485728;-2.0801124080358674995;1.4852645674424660438;-1.1400668211615381242;0.4215488657841509057;-0.77779163051894006919;-0.65067981472791369679;-0.60553944047310637178;-0.061120797001660599757;-0.013697731452589477497;-1.5073249215382078514;1.2110395419111137372;0.05100359353042178967;-0.34400230968777445462;0.13122262709444898476;0.18989945787809311972;0.20863727453271355139;-0.31917503259525614734;1.2973385107371131486;-4.145165073305146386;-0.9322651292690594671;0.92068427530169538731;-0.0032978255513978205204;-1.3418557074390420336;-1.4472059010078270891;1.0693861812411185053;-1.0300318721358199259;0.6328495454832814282;2.730491373167209801;-1.9084794299099556714;2.1479121074151192872;1.9542499774719601646;-1.9792948263266272324;1.8043742311656967292;-0.6474796817900684287;3.750336839172109471;-1.8946923912670843304;-3.8614256032735387869;-2.2629742094441138711;-4.447357962669356013;-2.7558675369392635623;-4.3086396012866012839;3.283802970939589283;4.6869280051400243892;3.8662294193393531572;4.9052416307003898766;-4.7545546529358269083;-5.2290471737095955973;-5.4223005042206668946;5.1606742321468770385;3.2544740799238809359;-3.5959204718744550711;8.2315946701475706249;4.4303165691955861405;-4.8119379526097443289];
IW1_1 = [-1.7046448785669061632 0.73883536892452850164 1.5258818274519343472 -3.6132271981625634361;-3.6341910118162781274 -1.4860763302030988164 -2.438993373999819525 -0.84190451623024009642;-3.1846769040434308451 1.9275128270923327367 -4.1095086625788876944 1.4538408123263997229;0.94726120633212118616 -0.73087753711031067105 -1.8187864872044794406 3.7603404862852936041;2.217625360467576634 -3.6464057429413148093 -0.9873600254693215561 3.645595955952739331;1.5602288579215359832 -2.8572821185497163654 -1.0399611875093051072 3.5077578750275737463;-3.2286786210217561788 -1.107963365493699337 2.5788323616047779119 -1.2001516969550429792;3.8200779419372405954 -1.9593116348451291575 -3.0222639329052287671 -1.4037041362745528161;-1.166622069846465326 2.4331085077896701385 -3.1192912006780550982 1.0861721054219406479;-0.39018482736766452179 0.1439620031125407873 0.29096994879143278645 4.3073850773661277458;-2.3112200444827331047 -3.6027831146674311746 -0.91403962034501917699 -0.12992763166672235964;-2.997085903192079126 -1.3826142614798737629 2.6069034254672800444 -1.6391874173122140679;2.8406705628447124212 0.97065227672484499788 3.5809606016345565394 2.3726558428563686576;1.8651291984160447424 2.7506716237672068637 0.77598844251019927221 2.8747048671500561312;-0.25569235688253844074 -2.3036222834902080336 3.8751023578170937789 -0.43035619774043998298;0.60872819571704006592 0.052666430027179245155 5.9785700888324910807 7.6001900480421280548;-2.3537771788583743415 -1.1438264695157822626 2.9688080183321008398 0.92739414923777574451;1.9513749995014264549 -0.14131934931314349413 -3.4665106220100181389 0.76847712790150457529;-3.2594989615850846754 1.1080366348051888803 -2.1960243889078325807 1.6981511430301090559;-0.92122425728873469364 2.3680277338179704927 -2.6236483050890169189 -3.0461654534052238219;0.28274523971354048602 -2.2025767824743538448 -2.5505763693851339902 1.8175913988923970699;-0.63428346128032264684 0.033958982370635312775 -5.6022648077165522196 6.3824459973851812578;-2.5608999559300595905 -2.251394221232427828 -2.1655709062433805556 0.1802433867385292432;0.87077694542254779897 3.1978371705703203531 -3.2193639412818564338 0.55846950547978835289;-3.6147714045513335002 -1.1268685475306199351 -2.3728183397858781944 -3.0476786546062384353;-3.523865870030048697 -3.035822069517498889 -0.43262992780561970729 0.22584227871523579467;2.238020647291281584 -1.3694901719088685699 2.2564704372807149468 -3.3210790692192180273;-2.4671176679172193147 -2.6319374073703851735 0.5565220074693761898 -0.14479665132771071812;1.3943684650337959674 2.6335411496813998511 0.31181249265086397049 2.5711131649954315215;-1.4397752526454978828 -2.710961374721038819 -2.431090817275182836 1.1720061813869455669;0.69618777694177069737 2.1045029714809238008 -1.4668675110472386702 -2.081455458685212534;2.2799454062002464383 3.1543482513263714218 -0.95069136332196824135 -1.2135129569600886512;1.0219469706148238686 -2.3550652066234483151 -2.481626194904020366 -2.5562558922451934507;4.2917805127453139136 -2.9098549773649793337 1.0704188886390262336 -1.6265945554901304337;-4.7168165956650112136 3.4703418511452066575 -1.2417721334705651426 1.7858596333272676038;4.0686926291051310756 -3.3813866943880785954 0.48206892285896213446 0.15723357063067017192;-0.45982891166557332552 -3.9173459565747958955 -0.70707555714947178949 -1.8484711789411494287;-2.2013019493573136032 -2.4361253596813545741 -2.6260780679876876142 -2.4524251418168039329;1.304397513345440629 -1.0447630561718048714 0.88938694577141730324 -3.9785669051116192563;-1.7876595334969611617 -3.6784412998363564817 -3.5108515770971160386 0.75842812460484609893;3.5709847249786368373 1.6329889125834682329 -1.9540526902477051152 1.0147200000964196054;-0.85959170929116412996 2.5201937676115413467 1.9045314993965751782 -2.6286063078383787861;-2.6054637974122112354 -0.29977787340189482324 3.4103240537168715285 -2.2490108388047751475;0.73572319744273195763 -1.7084581331140165084 -3.3925072290197157976 -2.7318220930864227647;-6.2084199502895076606 -1.9073074426100729006 2.3658680774275215875 1.5690031734130418517;0.030384375069197853969 -2.0908316656945715728 -2.5800359904427145885 -2.1492757665909945075;2.3071094721456661958 4.1325676155181243487 -0.10355867764022368138 0.27867246183630239864;1.3861527683406613676 -2.2895658912754903724 3.4445503233718035574 -0.72511516732693936937;-1.1634849063056655893 -1.1036788823690220074 -0.37770171446439809726 -2.982199320530424913;-0.79342902045492669227 1.7564311287280798268 3.1763527809486027387 -2.0539430530824098753;3.1627062509815098146 -1.8848700224128098757 2.7606038811494446605 0.64119324127165799876;-3.0317832796369015291 2.8805319929558850234 -3.1084726826035198322 0.82677078621044719497;1.2752621312819596433 1.8438346195724775178 2.0461622757500754766 4.6491386299903050272;1.7418890117054073308 1.3703353000032179043 4.0588520696656233966 2.0391851310402744346;-2.0970805121061157905 3.2602417094056579394 1.8730109470768945279 -0.29402445910947655472;2.1940093052479920921 0.76456141485678930092 1.0831908029732397747 -5.8723069989233209753;0.14947179825897963235 -2.54226383243477283 0.089869032582926958175 2.7527416297746607476;-1.0591835352771006296 2.3504231460642861506 2.8434586440767994908 -0.52111405625300033506;2.8702067791064176383 1.3761441115310588668 -3.1181736027476096851 1.3279509627309116215;0.38732165023517622915 0.062275906393625853064 -3.1346390448890519842 6.8809086447203897663;4.3686587674960613015 1.7151921691866498509 2.3095840681286414764 -1.7241842101311435353;-1.437966863433366882 1.8970415366355017905 -0.45161630793411766671 -2.5204824198650368494;-4.3027599947597643393 -1.8937958959912060131 -1.1105373139240679592 -1.8000101738910483373;0.1991698771132632273 0.27727932088424117607 -3.1155059386784138553 2.3332606626656322568;-0.17670681666670204346 0.055841885428366239141 -0.73300962357045984508 -9.0705987338203364345;-1.6234762954553016989 -1.8380631037657875204 -3.2268516583085466998 -1.4048090169667521998;-5.8265707655925753627 -2.1571292514223356918 2.4889187888084651767 1.4585542357774319289;1.4201400304449847134 0.503849771935320212 -3.1782853067223881816 4.454831008381530566;3.912932381169031526 1.6187668650207640564 -0.25589719892900564258 3.3151329417007824318;0.071052058606549894915 -1.8915631356883220171 3.3222317233415972204 -3.2905211028865313239;0.019003524846198310144 -0.078528480233264072452 0.77849083905919269633 9.7534231489132636739;-4.0329561202254238239 -1.6473625585039057828 0.66460397335542231723 -1.2118247637324743859;-4.7158804951394754923 -1.0725673012728276223 1.722681340637013836 3.5349137248158895019;-0.11184801237851543787 0.031819635279291470786 2.0446418200065554771 6.6535229005613354403;-0.24130513213684864904 0.82852828043325188467 2.3143097471156495182 -4.0992691453449294769;2.2608776359289906033 2.5584097406309957989 -0.82826704641814330454 1.8225892371447593998;-2.7098972761440944801 -0.72264924169723709912 1.1710669133612960913 5.1074642421412344007;1.4323572861225994934 0.11944308004805975765 -0.020107313961030531119 -6.1859347998487130837;3.5472381607320628838 -3.2944635114428999501 -2.9399844353069246594 -1.7534184599165398843;-3.1772056392053711349 -0.37910251716970361224 -0.31925190437503303542 -2.8533073853047974389];

% Layer 2
b2 = 0.62723930461016530469;
LW2_1 = [-2.3983083837312859643 -0.93940037569928325212 -1.4897407825594068953 -4.1738196245011538466 -1.221614966376314948 1.8259997261150322512 -0.45068913060627224798 0.70180669939818718372 0.052741541093422994457 -0.31407863414743619757 -0.38267106979813858558 0.71645709149156888707 1.1342466309444936279 -0.68478713192815809929 -1.8337047506550836484 -0.85338829748230671246 -0.97204693992472424036 -0.60267612707845852338 0.33765209722428735084 0.15192264289986553982 -0.63247683183863201428 -1.0379289033750307425 0.65177208417342025193 -0.86474395544911231148 0.47868358374472735894 -0.28261924403804794537 -0.15347747581172940801 0.70524063293675898212 0.8432721925968964527 -0.35839780419405653511 -0.49293491101145020528 -0.027707337136018417301 0.225751496562536208 -2.1497906329572065154 -1.6067248828859816978 -0.16566165073131308705 0.11865712627228641729 -1.2647228734564206487 0.15760479369438346042 0.64990503971328006383 -1.4284472665314078554 -0.45739092138846315638 -0.31862205132018078801 -0.34281577694783166299 -1.3973868855310676018 -0.43920874383253605266 -0.21893334655712667902 -1.4126297957094975377 0.89146099591314043042 1.0492115402319421857 0.034520231258994601986 -0.63446668925616667156 0.3341420001891826641 -2.059703924431593336 -0.23711190198641621252 -0.14542623973139301441 -0.34404950480977147809 -0.096040802331105179501 1.1417744956337767537 -1.1119055326948594775 -0.47048631281559283313 0.27758809204000473025 -0.88772988216202219913 2.365493898175083487 -3.0088496888742821689 -1.191194128336386715 1.6318326455202269987 -0.14371947023194472925 0.47901960412099048314 0.49892054671716506986 -2.2195789137725934204 1.0714640943059279277 0.20031590365450657742 2.1263312175014821293 -2.0035187410810415543 -0.98867759471531946325 -0.18581837561251532409 4.1254502834241346676 -0.58065907670485550351 -0.34087311990718527355];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 8.69565217391236;
y1_step1.xoffset = 0;

% ===== SIMULATION ========

% Dimensions
Q = size(x1,2); % samples

% Input 1
xp1 = mapminmax_apply(x1,x1_step1);

% Layer 1
a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*xp1);

% Layer 2
a2 = repmat(b2,1,Q) + LW2_1*a1;

% Output 1
y1 = mapminmax_reverse(a2,y1_step1);
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
