function [y1] = kb_biblan_final(x1)
%KB_BIBLAN_FINAL neural network simulation function.
%
% Auto-generated by MATLAB, 08-May-2019 09:42:06.
% 
% [y1] = kb_biblan_final(x1) takes these arguments:
%   x = 4xQ matrix, input #1
% With 
%   Row 1: Outdoor temperature in Celsius
%   Row 2: Month [1-12]
%   Row 3: Workday or non-workday [1 = workday, 0 = non-workday] 
%   Row 4: Time of day [1-24, with 24 = 00 is treated as the start of the
%          year, i.e., the first hour of the year has value 24. This since
%          the logged value for that time is primarly between 23 -24 the
%          day before]
% and returns:
%   y = 1xQ matrix, output #1
% where Q is the number of samples.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-12.5;1;0;1];
x1_step1.gain = [0.0436681222707424;0.181818181818182;2;0.0869565217391304];
x1_step1.ymin = -1;

% Layer 1
b1 = [3.8940811329619058334;-5.797743759818670739;-4.3363993178030044717;-6.9435332851846958135;-4.4147602446832490131;-8.0256961597045712864;-4.4843655639126653867;4.39602401143733168;-4.8392250137277752486;3.96832580606639862;-7.3258687734844398776;4.9515298247691070799;-4.3195816930290229507;-3.9020327871839519673;-5.0553262646573315919;-4.5556064722848024218;5.086019196646822671;-7.1655448449069174544;-4.4584241848565042687;-3.4244118422769815879;4.0714229880361481051;-3.8817869822390513868;3.4828838894801021908;4.7203685142702695998;-3.4522498935239918083;3.66340600543016226;-3.3083819476931597414;-4.4955450132060539303;3.3021188292526320041;-2.9409285832434810537;-4.4090142937239322762;-3.7995384699920635718;-2.1467713286423220076;-3.6543398176230512675;2.7580683531170313572;-2.9934639360070551817;1.6921956491584861926;3.5197093172985107756;5.2016742470479266913;1.954024212472845079;-2.0530336198598395647;-2.2145493143749681586;2.0292107982531368826;2.0670578975687541323;1.2560556912587468315;2.4847241593924165315;1.7980028807252230738;-1.901392396063785073;-2.142234075932629711;-2.8124382430972829638;1.4478983091279917783;-0.65904018120428298211;-1.7696649103035098083;-2.5775975910342840969;0.76988777590553247876;1.92244605977815608;0.77848688408337496369;-1.3456902658762286418;-0.61343536158892131294;-0.81681222845527068355;-1.3593317531495721084;-0.77640355916621761612;0.4914084542588831872;0.71526529977250541403;0.98967336511090486795;1.3802262378485830041;-0.36995073600157651894;0.30842126278606740719;0.029109134974199288998;0.54679817228274751884;0.57916072654906303185;0.49339761709168189485;-0.68752738861966433692;0.12716687208536972542;1.9545319109251211298;-0.91446373161125693585;0.96868286919764756693;-1.4930122438724238165;-0.3366432276698881898;-0.44356257289524714249;-0.69036855559835774709;-1.528756490117837652;2.1816914283109176687;-0.91310680406981392654;-1.1536251515628987985;-1.5488617063107603666;1.6397387255663729011;-0.56645691924270025197;-1.9271613862909957593;0.83496159278669701553;2.3790459596180162372;1.5256082746432990671;2.3052413504059954263;0.90108484167896607531;-2.1731898601129353565;-3.0030650790861850297;1.6634289942445215083;2.496509034520195236;-2.5163512849985001374;-1.5771618932949882375;-1.6223464501145599126;2.8960312899142164333;2.2788412618169431312;2.9758097330874204722;2.2713722336460220319;-1.8302852560377733671;-2.2706147724689547118;-2.9399643372267245667;-2.3922358418854288153;-2.1255971792327583714;-3.0503915133697279138;2.2665747320676037369;-2.4601935961971439504;-3.0806745845070251377;-2.9772380584505269141;-2.7467248871261391585;3.8217242447944514971;-3.4958931892528077867;-4.663242293719433107;-1.873337552393073091;-3.4235774370337463957;-3.1450795777116979934;-3.6553754414002663786;-2.9284724199926697175;-3.3037217833762730912;-4.0784502697326967535;4.6775430898866794394;-3.9762035183736772481;-4.793268909109242415;-3.8560410208076021377;4.003812515912302139;-4.7221622562847400673;-3.9522872530681270042;4.0418245874735516665;4.8443114739704427052;-3.3691471095169336358;4.6573805209066581057;-5.2277419475461970322;-4.739499791264667472;-5.1819206524471104203];
IW1_1 = [-2.3994820940584040692 0.82244651935492274486 1.6314394361452466686 -3.3579473663356904645;3.077608100326465479 -1.0297438085983785516 -3.0524005093698680646 4.1439776457830799217;0.49624220898914706002 -1.4336645864400363592 2.4681458057937510908 -2.8792572708001764603;8.9316017575158976882 3.5819101673590534318 1.1358896768697861468 1.6728838583541589813;1.4078147376398715274 -2.2923834757615053626 -2.980010729708053141 -2.5188302153688710838;9.3981949645176037222 -2.0899312588434817428 -1.9750479294596647861 -3.0377691267087900684;1.1536686050688749194 -3.615731957613273817 -3.3928258040133782991 2.1465329581756535937;-3.5264138606211501425 -3.6279565142265304267 2.2153488566017878192 -0.73367843810832056306;-1.446756637621785746 2.3233195127756252063 -3.0421247852454738059 2.2785275150326529392;-3.8204586851502004841 -0.69511795603031678592 -4.2958150746007897069 -5.9783165927837638165;8.1385593996344027801 -1.8859072131364804648 -1.8452094966598664438 -2.8914995748975425016;-2.0967499568986172065 -3.1175176115223002249 -1.8335004344511061092 -4.152800457206136997;2.8928063918736310889 5.8490324716341657307 -0.13996324842888083206 0.66862491467025120251;-0.36186508403916095578 6.4638990452250562058 3.9188265223094349565 -0.039259016006506129715;5.5586379593892685236 7.1195684879095830766 2.8173588053137121889 0.7883180270669836176;2.1243339423107410191 -0.68237566140726668706 2.0758521795706705859 3.1061636064001829638;-4.4472457035698509387 5.2404877044300093303 -3.0703742338139803358 -2.5644670079617828407;13.017307802257223059 -5.8061205935033060044 2.1962435535087729832 1.2702320189607168022;3.8610083605178897592 6.2591142413897555841 3.1136423246801654408 -0.45424659688595281359;0.94335031647098033236 -0.4660224803325591636 4.0408816897735047036 -2.4482320812898219486;-2.4006431156544776329 -1.2286139817027015297 2.5008523092920804665 2.2408088610018794817;1.4589666655779778281 -4.8286394861937527168 3.3231942067700619425 -3.3573908060871078263;-2.5049300114950088236 2.8074498846680873143 -3.3168967428784479345 1.6522072012869988278;-4.3798451865036547304 -6.4483818771432188655 -2.1865833135820351707 0.70198737736283445265;3.4849206388437115045 0.44192837938219736715 2.661527194818460007 -3.1493468901105456936;-2.462120393677053265 -4.0608276746799623069 -3.7391290639707763788 2.3020777043634699233;1.1379441087684918354 -0.057617578113937098494 -2.6568218525732554269 -4.3230473824440460717;3.7289455503887589671 -2.2317538032995702935 -1.6233740382723984563 -3.8483141970988246072;-2.0465319550928753323 5.2334759671778030565 1.899455228370069193 0.18003835413497587536;0.98815558213401122334 0.93384925787734152092 -1.6392166971081754134 -4.0182009294235978558;4.2397293837663960758 5.9036753665797210289 2.2308686815118328184 -0.75288801862824683564;2.3144282777337932266 2.5960695916537268602 -3.1287052737391944923 3.1055126105809298664;0.40071871965357791501 -5.251866451542308134 -0.43525074500938276678 3.8999139990847533355;4.6989185499059145101 -0.7543701703023144578 2.0425256435293155377 2.7784062636137214497;-2.308541062791177545 -0.34104313026778226847 4.0939413890166385102 -0.062466410575401434824;4.6224340098334737448 1.3052228647617891699 -1.2360659557517554852 2.7435483750949485326;-1.3823921263100178436 -2.743019230076116699 -3.2390522053407599934 1.9357175335139698014;-2.8284213188243962911 1.1431618059964618883 2.8142479915565576931 -1.3994921697298741137;-5.9087883770807447803 -7.3796569351304990292 -2.9545641838499863141 -0.99156069124163814799;-3.6704635057101997475 -2.5787027494011778295 -2.4800349890561386168 -0.30843299262737505773;0.2884763209042495169 -5.6591811514753320722 4.3624544016383488554 -0.95833962047270004891;1.0743104964450225225 -1.5595551727280525522 -4.2548907440937284719 -0.26890014350124985532;-2.6044341025674118129 1.8220012616933844996 -2.7346718341500282357 4.2903723376276809987;-2.8085045818803018314 0.80132995855719524325 -1.7833412901097001058 -1.566354379397095542;-4.3438579324063200104 0.089271721976283607836 -1.2825930606059383621 0.795789619763691225;-2.422293225998163102 0.0022366651955526041518 1.7505366805863886714 7.1790562578729364418;-3.1149422374174822181 1.5613877744262729674 -2.2622195068265429363 2.8979903347135960168;2.506162758353204012 3.018285936063165309 -2.0227014320246952117 2.2329205047096709613;1.9817574539239013465 2.1268863471378574026 3.0990447005157588656 3.2858154583397993775;6.1700491610829288902 2.7867521833443875678 1.0788919727225048106 2.6099646581560902447;0.02949629779517396605 -5.1398767293380140941 3.4690983585716224091 -1.790449348551490516;0.49643992046827040143 2.0118588735465561257 4.6979419336425634057 1.5639800344140388777;5.3814735920160154947 5.5306076044742198405 -3.0585766185369598347 2.0935963869579010677;1.6674905347805641931 1.7763799524050587486 1.7626168368533392528 -5.0611407185366967809;-0.55432084590273711378 4.8355374108594935123 -0.19068533786193586632 3.3893317092337520435;-5.6715702976466513263 1.8124560081007239365 0.20661227176992830179 -0.74527723728006312065;-2.6915582736028236255 3.496768501185834932 1.8884696494347033013 2.8499854884065149996;2.1198969727752139391 -4.4279642189165215882 1.1184030261294672925 -3.1204992207142931981;3.0461867279124641428 0.36424552330149301271 -3.258570289517363161 -3.7908357710067464019;-1.0346349777990853092 2.2748502819037663691 2.4884671313691968386 -3.7871673071165044;1.4307711841747936532 -4.5814954271691430421 3.2333725985308401363 -0.56443525092339841276;3.0331817944543657539 -0.71547209285703949888 -1.6778088909069941437 1.5485560727001310699;-3.8273500161458327007 -0.14072802237256845648 -3.2867749070316940596 2.4851898201335451688;-3.6540097388995422811 1.0109457494130036359 0.44976723406670071626 -4.4964127329884444606;-2.0663782588632817472 -3.1578147403153864481 -1.9730822112677663949 -4.2475921926697859377;-3.7374705406558677012 4.0545837231256003363 -0.22071798203102369063 -2.4292636416210489081;4.0730964325482084121 0.9255102319718788717 -1.7732468623254535878 -3.3227642029862929363;-2.1531592892327737765 0.54733536839470986468 4.096626028892381477 1.4634215969549202452;-3.0151796322793185112 -0.86947994315441834434 -2.8615033091305259738 -3.390337716154482095;3.1810155207852162107 0.87930938416787574052 1.1414222839392005326 -2.9054411441922152193;-4.7439045287477537016 -3.1923760716848783581 -2.7177861370202904823 1.1473242038366726625;-2.6058567675148385234 2.779495727379817982 -1.4347809608134822756 3.1427408651472981127;4.0330216477461693358 -1.3888934687305654059 0.75856126775994259237 0.5994639306114956101;-2.475120297257091373 -0.42233394151293179863 2.4042882172816391062 2.5034667683666880222;-6.2472928433933949677 -6.1063504008110154331 3.3837067702954026771 -2.4293504179938341103;-3.0009664173366519258 3.1119289883344598557 3.6258490858842327142 0.57644662185160977508;1.7748908428498118006 2.6854154510120706867 2.7483173804611618074 -2.8921069959290734985;-1.2407300309642470548 -4.3445537184753408866 -3.8022750122591917332 -0.9155162062112921495;-2.2371596858891908965 0.28950001122491075822 -2.7985969075127141714 -3.2767612322595347507;-2.7792277673289786932 3.4160969087053643101 -2.6295350670347992228 -0.29609820140321990722;-1.0577219505710637737 1.6926792250216826652 4.9696188076091623032 3.1327111328545793612;-3.2677007593200388946 -0.8406782414104132517 -3.5407789192874079554 -4.1827999279154175483;-0.011859522397703062269 -2.8578979099192913793 4.2364751255327810497 1.6938208351200565449;-1.3731910421535671318 2.0420029123409992877 -2.795434918135582425 1.2954946504924387263;-1.9348613677004045108 -0.06226113051534554188 4.5265674461329048484 4.2041819606051218372;-4.1796556518773986255 -0.57992998790336047765 2.7197302122802993196 4.304484172583831203;2.700008505566653394 1.5745906119480630458 -3.8781579781664436979 -2.8922484371847501095;-3.4108819024902206074 2.0375034631392598961 1.481090710793943499 -3.5422409063995274892;-0.79608839351077420599 -2.0468392595966555803 -3.1912839407185602525 -3.6299359079338349154;1.3289290090074183937 -2.1706755929946504047 -2.3870278132438289553 3.6685067322630722231;2.3619615724739455587 3.7961851497793324128 4.732716198337862501 0.76509116099872276351;2.7173666710567223603 -4.0958368634334165748 -3.7285065584077541345 2.4570358417517912386;0.4244108332881678658 5.5378304850789943359 -4.6185996701366436312 0.96474717321047354091;0.67414221670692153765 4.8196457508799293024 2.4715274834830602835 -0.35241418794635970269;-0.42477488790760731252 3.1168118374807551874 0.35555605794647238138 4.0921920780396670025;-0.65932126864953266576 -3.6203607098122891905 -3.3554204267358826996 -2.412304680860452244;3.7605043754443165938 -1.8146872007956846851 4.1970553280575897404 1.5247013644517211084;-1.4947210418982765923 -0.014925106006237790282 0.65065245895799206366 7.0626075587364018915;-0.88294247872864550786 2.0472615613882880758 2.6084062148406523818 3.0033860165100905171;-2.2959872711253979105 4.0849274890944675676 -2.7808060214481291617 1.0802607163796553724;-1.2526730782169002154 -0.62647515580652313183 -4.0462819598014849731 -2.7892095539635133328;7.3997675796769506462 0.64911286894782005419 -7.1920891001754512217 1.6651659828492377802;1.4475609494261036936 -0.16775687432682689915 -3.7586219701996119724 -6.3162457248623375961;2.9472664317378272081 -2.3329110312123129134 3.2129157921695461475 1.8997949744505264746;1.2737589666094935037 2.7030328366940974405 2.4519595974205641298 1.801426682399918322;-6.449327256875111658 -1.3036607960578450172 3.9289971051654175582 0.34167240954283883969;-1.8423836841631524575 3.8867131344894985112 2.737061593072727117 -0.20752812949207288806;-0.28082016349898131224 0.24724751670955608107 -2.6688274502856277337 -4.1475347416853169946;-3.1665322009103906709 2.3477579375523811578 -1.4535794946424631657 1.5524026987995249716;-3.1293117164542927355 -4.2479724968119789708 -1.4504477785759342101 -0.84670024204712601712;-2.5304010322615542172 -2.4330536064008208008 2.3810398838042887704 1.7482382292228149101;3.1559008059591380224 -3.4944478581008420193 2.9505931690201152584 -0.20452179935276176836;-2.3467226337631217348 -2.8754740817320123547 -0.16108807443479025712 2.4323561152983090849;-2.0756899211810249106 -3.1006641789504718609 2.6636533595276818964 1.5921400096686189052;-2.3871008027431366294 0.30841818470610210534 1.9197185442934194821 3.1647481761690765545;-0.58804695861398459389 0.16193224322148194738 -2.3853781295838953902 -4.2396454533954592847;1.2590375195257663687 -2.792471960754428828 -4.1371456959891137473 2.7124212180978588549;-4.2270225343998051315 1.615234214076072039 3.4799221222359308925 -0.58196772874638369455;-1.6430758688537259182 -4.0351887987839791805 4.0017439234815519455 -3.6839330659754496722;-1.8070580628045793681 2.7020153764806380536 2.1804659218153830125 -2.3968890340704609443;-0.35671741659364453181 -4.8421017177912490936 1.0366362180132209225 2.7785645113549524154;-3.0040416392170157245 -0.74531192853842465063 -4.1799562592460945964 3.1745408590085877343;-3.0047942581890119129 -0.41066887381663458312 0.96597079283754838652 2.4936322700062079072;-0.94641204679133705824 -1.4431489843369931236 -3.8652202516563671786 3.6729364779168469646;0.080607814394926133317 0.75024749124375078591 0.72161521995283084419 -4.6704821471179913672;-4.1431340401915210947 -1.2707096881656256837 -1.7472405365974643665 -1.47689978217445117;-0.98630111105509810088 3.472766859569470288 -2.8777411459203205979 -2.3670792389579493609;-1.9675499446144482096 -1.2217545579202639949 1.9500495594248730136 3.2129768924727621915;-3.0248660422970319317 0.56097929223410603061 2.6232298870940913282 -3.5408437485149879542;-1.0944765578207857892 -1.2443031926367913442 1.4586092077378631782 3.7430955039585649402;2.5767230390012985097 -2.5004950468012423492 4.1012871833364243912 1.8097513548497481395;-0.86575771265695666834 1.7559891981718600551 -3.3709294863919772034 3.7089731080423957721;-3.8717433090743194057 -1.5907069357594953996 -3.5097284403428048449 -0.65311819648712876596;1.1798926869250594418 1.2510882916645065244 4.7663107845699217435 2.3384655711487356555;0.74857111568394285595 -2.3191209963262617855 -3.7118868439318903896 -0.53111356920861263475;-4.2723146126642248532 0.78319697012175359951 4.8264252669635157034 -0.68890314623020176832;3.7023231510873757522 1.1182665662037982734 -2.2077048899841229535 2.4111760916884716899;-1.4587987444011136784 -3.3505200107665649156 -0.8221427459055994369 2.954539424656545954;-0.36547461318539786745 3.0455060376918483556 2.3730243186804091948 2.6020007383680954227;-0.3320201044615445074 -3.963409214544906245 1.8054457455513650554 1.4765734172954034786];

% Layer 2
b2 = -0.58396100482275126176;
LW2_1 = [-2.7001902071702503783 -1.5949395429156065784 0.96900163391834881477 -0.31961428428627502996 -1.5008939032949035752 -2.573608573343456829 0.86747545174571660809 0.5337658168432992678 0.56844723063616964254 0.10353621015453731702 3.4803813852536382711 0.23224919857290066139 -0.43548767632738227817 0.46880341927534380231 2.2172849230560482958 1.090419137971217145 -0.35280914833695820043 0.26290944260065329807 -1.3053160167922617241 -2.9909568945846465304 -0.76180541675328328211 -0.62154558923294989103 0.71404036589814268154 2.3518366160131805032 1.9102542181500006269 0.50720957888908391187 1.8965385476240270712 0.36327731631145604441 -0.32653663710690444821 -0.89772666868861172862 2.7636539342937593844 -0.45532697567434565755 -0.26170726095712176784 -0.57669990107631030618 1.0443629702163028661 -0.44395495642138838033 -1.0324576196004753292 1.6739138324994389251 1.9146455753936493238 0.51602803458929880076 -2.9090412646032128841 0.38152375012161487966 -0.47388582165560666493 0.84712087633316979218 0.43092252541828190981 0.38458746725298464941 0.6587128189271347356 -0.59857753638954769304 0.41361204205798157707 -0.13895756462597880221 0.12317481756179773922 -1.5270263911772881116 2.0586856962041597541 -0.11977003864438834357 -0.3947847969652667488 1.122422197366809149 0.36002266748356509529 0.46916548234047722454 -0.93774944215520172897 1.6208481734052799794 1.882946887447357609 -0.69242150990909290265 0.71575452044121501416 -0.21839311299460834048 0.33283397835474837212 0.44511759766823200124 0.42972965000250501477 -0.15919678412322266214 -0.45253360414174459425 0.64007145210291882531 -0.27641583424409038594 -0.38198182380274470216 2.4765475814118671494 -3.0212182847140138797 1.6254539619623495916 0.42837112151586387299 -0.32634481903924250634 0.94908871608121025965 0.54973755541247981693 -0.83702520673883273883 1.7946342624733628845 -0.31048452115756985936 -0.55640296481160977926 1.7732517298189323096 1.0835310831954370059 0.79770387319729396669 -0.37879712366778078847 -0.25295929996910210269 0.75730216996542143448 1.7571802084859475812 1.4903210264028310394 -0.54226157356289339528 -2.5322622047901113262 -0.24135185634149664002 -0.14150051027929316794 0.72563841192073286201 -1.8786392272896343947 0.41234161790317452878 -0.62962008002914193749 0.5512207770128566553 -0.23211543312131815986 0.80366302502802211549 -0.41397282497089316067 1.4671944619178323155 1.8549074248713137703 0.22961608922646206676 -0.52820649458192114878 -2.7664210028240425743 -0.32499806298366457069 0.29292070777139139759 0.97312909491679722152 0.59956818774657227866 0.33027017890009824352 -1.1673314527576250654 -1.560685333608469616 1.7964632908417432766 -0.87939914172310051921 1.8811359847783677424 -0.19556126343810953383 -0.84637796386065711207 0.41431758003870416962 0.52501433114703677241 -1.4478304142410638455 -1.079057958154865382 0.19293209385595233574 -0.20348203342983403608 -0.75701607262059522618 0.88095972271823419497 0.31164605061979183676 -0.77593247386684260913 -1.2875961716336674634 0.38989192132526784285 0.27507414325091616991 1.6578106695453802555 -3.4882474471421427431 -1.7883587190444008019 -0.20014511211694488435 -0.26392973279242681883 -0.34052013372894379684 -0.43828727335274442201];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 64.5161290322581;
y1_step1.xoffset = 0;

% ===== SIMULATION ========

% Dimensions
Q = size(x1,2); % samples

% Input 1
xp1 = mapminmax_apply(x1,x1_step1);

% Layer 1
a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*xp1);

% Layer 2
a2 = repmat(b2,1,Q) + LW2_1*a1;

% Output 1
y1 = mapminmax_reverse(a2,y1_step1);
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
