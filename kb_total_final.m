function [y1] = kb_total_final(x1)
%KB_TOTAL_FINAL neural network simulation function.
%
% Auto-generated by MATLAB, 08-May-2019 13:27:43.
% 
% [y1] = kb_total_final(x1) takes these arguments:
%   x = 4xQ matrix, input #1
% With 
%   Row 1: Outdoor temperature in Celsius
%   Row 2: Month [1-12]
%   Row 3: Workday or non-workday [1 = workday, 0 = non-workday] 
%   Row 4: Time of day [1-24, with 24 = 00 is treated as the start of the
%          year, i.e., the first hour of the year has value 24. This since
%          the logged value for that time is primarly between 23 -24 the
%          day before]
% and returns:
%   y = 1xQ matrix, output #1
% where Q is the number of samples.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-12.5;0;0;1];
x1_step1.gain = [0.0436681222707424;0.166666666666667;2;0.0869565217391304];
x1_step1.ymin = -1;

% Layer 1
b1 = [5.1954966095031620554;-5.3454577160509710865;5.0582926655228952484;-4.6529535915829507431;-4.1959206362273642199;-4.6774795335430034982;4.8623715607340542988;-4.1951231123701697712;3.9099724376109841195;-4.0455716487749269206;-3.9786370081171447133;4.1555470206738629457;-4.0229788807238735515;4.1112749455440527058;3.8102934830859589432;3.895667978490561012;-3.8448096975903127692;3.8670910310961641443;-3.4591168157370764114;-3.7892482021256048697;-3.586702286274420004;4.6684415843543050073;3.0762143148199809772;-2.8748456065792411529;-2.7581960821743543022;3.2248437946898240725;2.4051846843408530852;-3.3620582151687439243;-2.4437175773459967054;-2.7943644150675281956;-2.6013495054335105117;-2.3018440681636440637;-3.4304122141808441881;-1.4664345310103288345;-2.6120312520126005573;-2.3583118226117365523;-2.0966103997392830927;-1.7518367601391855448;-1.6718189127768758873;-2.2922298740523054938;2.2104940799445493838;2.7588582178575489223;-1.9549341869043410647;1.5009044803640891885;-2.0157868023498988208;1.922583166913049979;1.5849146108596570137;-1.6198327022370686556;-1.4244798471527901906;-0.97158459582742784377;-1.3151382512960432258;-1.9967953762398489292;1.1351430506137831777;-1.742258163129775772;-1.0659693250667188202;-1.4624425096338438124;-1.0389032869168581819;-0.95830644157796973648;1.4892408658707745328;-0.2696814121296506328;1.1910719478012499195;-0.65807946098557557058;0.864082880108941076;0.16607408235076048797;0.42840477601284915332;0.22811832475841137269;1.0786332793115371853;-1.0200032471567797021;0.32884799891117039161;0.10026257754348499862;0.33415223119836501287;0.59112833410826015612;0.04759489656672920288;-0.64936340623327315491;0.11969285791865436064;-0.4968515602139277898;0.35504592197817619326;-0.2489354659761204569;-0.095526350357345343745;0.26940381952436670554;0.67432261153145267585;0.80109552817056606244;1.3583551175873764816;-0.50188553807250402272;0.82183054952688228134;-1.0997733907069069392;-1.1676839228159567874;-0.95749083091727194006;1.3162003813867420021;-1.1124646107956026597;1.5384088545920262536;1.8367095959524315507;1.4951140975967318614;1.9415585692957819663;1.9107528056398364047;1.3715376947108512962;-1.4156389407664187186;-2.0799507569517792227;-2.4559835378214436297;1.9682133607393534902;-2.4090915731408699685;-2.5895168458519242094;-2.1689247958492434698;-2.7798597691797617415;1.9192088738002406334;-2.4939102717236178997;-3.3032910178616705643;2.5699357983987227705;-2.3232490724028962426;-2.0595735560416223997;-2.6380157079908910234;-3.0202080479825803572;2.6216236704761097798;-2.9644843927531439043;-3.0384296945733768602;3.5093090787811549447;-3.3991895873982018728;3.4115952430031390996;3.1613543344464574147;3.8296035852506995489;-3.3105284816343671928;3.0420365405069134113;-3.867314651417653959;-3.4614658138821208233;-3.9760441749835453429;-4.1173256393987154311;-3.6764800058635476177;3.8683615462127303175;-4.1757197815464275337;3.6542582547995339226;4.0625576157231915175;3.9883431486642590968;-4.4550483415449191327;4.4031394150536620202;4.4567204984471828766;-4.2334579074119700337;4.9937740739735065887;4.6066720211673173324;4.9549869819924996506;-4.3886974260845894591];
IW1_1 = [-2.6222886678354044854 -0.27316981060288786365 2.4058376968826604703 2.6188354061100755921;6.3120981318030722207 -1.1910982061103740914 0.11462970352597591506 1.5108096208178556363;-3.5714288445730071331 1.150445523092868072 2.4577139214929855093 -1.5535434070567888387;1.4779689167968639296 0.73614249201875858741 -3.930440125122049988 2.2141751730262400066;-0.25036289655860521908 -3.4893458819544589389 -2.7626726646825692235 -2.3607315434050106795;1.8698666853901848572 -1.6842316556524405957 -3.4782120115021242235 1.7990183052912533945;-2.5028831923852918884 2.6853784451648872178 3.1127598820361011001 -0.88571527240050684782;4.5220114394189625528 -0.013768278294344212312 3.2400727450268105301 -1.2844954588789598837;-0.24813425002550493215 -5.1621724621154472246 -3.0128590137561275242 0.49241927001421359478;3.6631810299572782341 3.6455391950712803251 -0.7367882754870582751 -0.082346318328238063411;3.1458653971716072917 -2.2956308327292456184 2.9543792515698594769 -0.77629940208499592647;-2.2638287730148602961 -2.9490272282831138106 2.6046479179628527767 1.404931988057815051;2.2252437012523174076 -3.1423232723243517128 -1.7217573350871939741 -2.5623736302533637321;-0.43046237516579211047 3.4592901213933449078 3.3584357474366854923 1.0138017188043100258;-2.8738548621923540871 -0.7133441055484518456 -2.9725972343088526983 2.7090992395272830429;-0.84366618082094635422 2.6134318817966311066 -2.3657933777689446053 3.0877267188152086597;2.360024254007713207 1.068685620562891625 -3.3660064183689275552 1.8994280281753095352;-1.6458771716387163853 -5.5540645334292992885 -2.7147749781680343695 0.24814991386194334977;0.22241208139551824075 -0.63709978825746826914 0.87220926487858219112 -4.7273827003772685984;2.7831162958701636256 -1.6175904746225806541 -1.6435240783907849593 3.1575215148275437294;4.0974906184430990308 -2.1131220065384761497 0.61011601272362470105 -2.6537495973082187994;-4.4626671154212456116 2.9252134639805151828 -0.25956172251237291659 -0.16206012827078739025;-1.2060160056409792162 3.0454993884648939861 3.2012955435238605872 2.1600888702917977469;1.941363502495960347 2.202601703765517005 0.30683666711548829298 3.913367580201024154;0.079766983533108001825 0.37536121709280978465 -4.5884844467199634721 -2.1636892605114073085;-2.7517842974975521564 -1.6806813488601042295 -2.1089984522807063705 2.5527259833429591929;-1.4498729331570134882 3.6667706116506435521 0.72714788195992230424 2.854764251041651768;5.0212177452784851894 -2.3859919301040770634 0.5423476379366956035 -2.2494973248360965457;3.3330085101388990942 -1.5459358417675590491 3.1669171822959230056 -0.45425573032236521431;0.23262497951341834512 -4.6023008923646244739 -0.76433532175524221408 1.0329339814702658273;1.5571981785442237101 2.5825977837291094197 -3.7562531728576962209 -0.56539610684303187593;3.6952456365736403576 2.1362694260401551283 2.3670008982085324334 0.96239723328292203774;2.8116669461153711573 5.6937621133281268726 2.1144597869206753771 0.10617888662310290271;3.6110191597588694457 2.8843795693659841639 0.13938325697868267361 -2.3346414651600331247;0.39345975360342061444 -1.2961839402299988322 -2.3147972156361085183 -3.899520048444652609;1.5893837908596379904 2.528912250680269036 3.30420670376316572 2.2719406919178570803;3.2489479738999920144 2.9372987567595449931 -2.4130938737647658066 0.58867659817203810135;3.017583094054776538 -1.5367739113335470158 -3.7497873415910900619 1.5693123798511774414;3.41542518415887697 -0.75683216125623919979 -3.5304419574071266297 -0.42328689571590383256;2.5625555335342133922 2.4871926845268661488 1.8380243903409971828 -2.9579444067423370512;-1.1267247861727478497 3.4495436400190175874 -3.7133053231921655524 0.2136241852478320824;-3.4381740766819293142 3.3660929906579939441 1.1812861158082437196 -0.58230076305003897197;1.020556730796280176 3.2451493603397754129 3.1012385368415245068 1.4839566843705238597;-1.418155640100084991 2.8534287431816194314 -3.9791953133041233492 -0.81869464937519631498;2.384805538658612889 -2.5290331659388955998 2.2550747793295222721 -1.336802432603409807;-0.73034746843694720031 -0.86069379917059518625 -3.1757860782884339557 4.311267098532368891;-3.3730578789970531162 -1.4788582370135359145 1.4959606168953425431 2.8977523117196848368;5.0360134086492864824 -1.2005866728778693542 -1.6035629902047003892 0.91492954800060999343;2.1395751513217544648 -1.6565398511174895813 0.046504343124425237543 -3.9085128023559714272;4.9620442137910076852 2.6879996563110548635 -2.0519485394375611698 0.0081021922612512058126;1.9069156835865981314 3.4758737348669690448 1.2530376326701841982 -3.0855616447151703596;1.4119306022440332171 -2.8743479504308635519 1.1735201132212376152 2.3992258395930399217;-0.87083929094584355823 -2.216599056872869955 -0.55160769159098455017 2.4778398378749919573;2.7818053609266630843 -1.6372521569443734268 2.069475956967697261 2.4386221436304689192;0.059459267378763780432 1.7202772750153154657 -4.2795990502008356415 1.300711979593440093;4.1889047175736973116 2.5427971754363158929 1.5027491451483803164 0.91616030276108417763;2.5521289084366691746 -3.3423191788691166693 -3.5856687015227257653 0.97263377346690582659;2.042032447270716311 3.0570947027246777594 -0.70279794700891162762 2.8409220413397764382;-3.3820043024772585838 1.4856283438362412053 -0.051236147599371374695 2.8659105489994844973;1.6811982757793395571 3.35748485407183761 2.6384821295883980063 1.5989903601400494715;-1.2516841960710198833 3.7102583086429792303 2.6238685041858578195 0.88337154547186247378;1.0627696864784714759 -2.641438146851455393 3.7346732285662276318 1.0929106165567938902;-4.3005913183277888479 -0.93041324409083403513 -1.7857879089352182156 -0.08751009508560106398;2.7071202811832328905 -3.0191878465302481871 2.2372633826032526372 -2.398653018226200917;0.75266448004452435327 2.5677453156858804917 0.79906546448201731803 -3.7466362081881645629;-2.3603455355211453437 -2.0812533716776422388 1.8051121701917975937 -3.0607330126369221013;-0.94845637310758079686 0.93252161010050182988 -1.6149638345354329072 -3.6768121166832745672;3.0567815246298106757 -1.787929234921329158 1.0072554786116081349 -3.4325468636097102859;-2.6619113675996541879 2.4640274023409771686 -1.8549110356867835048 -2.958154242972093062;-2.4614186084702249779 -2.7757104552918989704 -3.2120191710008825225 -0.70922305082729786285;0.43660749442871799042 -3.7215006255497766752 0.0045878182799493861729 -3.087923015264127713;-2.104001985877765879 -1.5650416417144239478 -1.7244007415178865816 3.860171048003346872;-0.10078926889891111351 2.678840087458063568 -0.82461919795362492724 3.6088869050360359303;-4.5232313610055294717 0.88478397162575295187 1.5317135673740607249 0.38153139783467071577;2.0501177688447946856 -3.2242148525541201032 2.5336465180454790236 1.2586156726335264722;-1.7193464022598832219 -1.7928497719797291676 -3.8751659404970966172 1.1926309851398768647;-4.332770775062821933 0.841888456947076258 -1.8926018491914804454 0.1049297083207517689;-2.2639415379987988253 -3.6825923306944496893 1.4505168855806493955 -0.85714115642680732687;-2.5675696600332513775 -2.3357898630835016718 -2.6426081481495589109 -3.0940030018617448171;3.8803763067829089017 -1.1912221551227699656 2.5597235251153538371 -1.6894141725226645701;0.98940852191438455332 -1.1518758019501402767 4.3070045047030909302 -1.5113041338298800476;2.972231667421683543 -2.7935919246589038245 1.8722241771464509519 2.8062790478929056093;0.2021816624564786169 -0.90348205440746831574 2.6772011222344529457 3.7935752359602092909;-3.7323713374536326981 -2.5526134244628129188 0.82846638239066261455 -2.400943125025672753;2.5227877431323042501 -3.489283308638121639 -1.6168537955488810898 2.1920257310895419067;-1.2627396199451073056 3.3600476719832945705 0.61345845042478752696 2.834455094375239792;-1.5431538784278817644 3.369668842699547362 -2.6610338790380168028 1.3806231061498808188;-0.54222548337637999083 3.3374703892628980739 -3.4159832471377522545 0.57691255586955636492;3.8565149761566326347 0.9577740782710721934 0.98870297342358792747 -1.9723972358362380497;-2.04033911295607151 -0.28401650754131152476 -3.8961136635759996416 -2.4496101865933619379;1.1163622685861884776 0.13635536398668213209 4.0687422728368272118 -2.4736991385058302306;3.0417225168016268633 1.6268907309645452841 -3.7498654470826426888 -0.71507262880899391533;0.67653689701745922669 2.4599953654433153183 2.5099355320852505535 -2.779147534951353915;1.1763829303544277582 -2.8649531037596505101 2.3817091257825309114 -2.9800334854670720297;3.0734788059933846327 -3.9590560954816931272 -1.173875912845031344 1.0810454933011917067;2.1305184808280110964 -4.1090637500189268749 1.062545701237670448 -1.3128055864514096562;-3.7869544882882406611 -3.0719495363804392163 -0.31732373990012596732 0.042239267338638981919;-3.0935564920492684138 0.97995941598293667685 -0.58066103688778814007 -3.2795295408657754166;-3.3932273625498430292 -3.0040472062970589029 -1.1930178524722159228 -0.8333522323013455857;2.0905405681316628907 0.52712077008796409672 -3.6546988513648459573 2.6824918770724019979;1.0045746870878646817 4.3106746488349685364 -0.8127543378000778862 1.0638611124316095236;-2.6598388771846819267 -3.076255027617702531 -1.675142869514072208 1.0469375434578009898;-2.8735884760141705563 1.9279734755654438505 0.8438805434862768351 3.1082340278375379938;-4.7544371366777262722 -0.77348549611113581737 1.7521673272116942144 -0.27769733664776080628;2.5677911239704553914 0.7275704432926173304 -1.6737941552179600446 -4.4676202826930220269;-2.69140787331111353 -1.1115487844964255792 3.3225927800834664794 1.919486660307810677;-3.2813215076488755351 -2.0992018250263071444 -2.6023064027244742213 0.40446912434743770293;3.2515279767714861947 -0.96508005352294434775 -1.7340118008331750765 2.4588533695244985111;-2.6496018661395721594 -2.3958831848566504164 -0.57196948991919061012 -3.2666550171095418698;0.30693852741623034452 0.84634400327307013345 3.1688249417052185564 -4.3619085367265517661;-2.1825914469290976783 -3.1588312613221605218 2.6782325491552843033 -1.0380128502775827215;-2.0396054962670566724 2.6406410791393279958 2.5124244158483377554 -2.1757564030624476636;2.6343701416581231101 -4.1746612592475713654 -0.93476691977276471501 -0.075860843515559606143;-2.4938679577787139507 3.2945607805295762383 -0.38396528445855149236 -2.3483545518133763785;-2.3950139360954563195 2.706155314670264822 2.324217879381990759 -1.9263644243455075866;1.1310856019464055056 2.3459807352044337314 1.9255668549968012471 -3.4318632409709768361;-0.52943560896089902901 2.4918671279745554514 2.6267978926806687667 3.2438222260380276118;3.4364632876538232509 -1.6672957489428896771 -1.9712244331228576666 -2.075258073337590492;2.4905170862289316425 -1.2320217451965642663 -3.11983181316687741 -2.5842491901182254033;2.4960541980050683364 -4.0685680498188263599 -3.2484044441925092883 1.0752699642138456859;-3.1721055654700229809 -1.1319680053908733885 -0.4533066282333055308 3.2649426893961117635;1.2521779097994303331 -1.9395482986788035173 -4.5020129784281612828 -1.4583866384400998584;-0.14771937591435527204 -3.1437864885937072401 2.8438861372958528229 1.4507543016917865408;1.373451565419665954 2.2437377874839556924 0.37201300768124068163 4.7504083847993960887;-0.58706237718716813845 -2.9549744616469793002 -3.1769742140424508392 -1.1709054847395081733;-2.5278056199318124087 2.5031294295314538978 -2.6377349458673240434 -0.60580721419073679801;-1.2198300263000194654 -4.0951263377104636376 1.9656895613369329556 -1.5810158148757575969;3.0676653269324276607 2.8674275467328831368 1.3610673181809871402 -1.9039666464350561981;-2.7944248023880562393 -2.4385567433659072201 -0.0045831657114310843382 2.2952377996144694983;1.3846436938065622702 -2.6420305288263139509 2.4235228411850884278 -3.0888741907434198453;2.6192514781871469864 0.40411433105221389317 1.2040149267719122417 -3.0505701913455172125;0.67293479438208336774 -3.8702952854534293792 -2.3811366093626475937 2.2869106360336166617;-0.44907929737806695503 -3.1352897832434778458 2.8369781677544292364 2.134095961460563462;0.59364693795155998313 -1.9706175864259605213 -3.5837525773418259512 2.0563243019175430071;0.60453379362616244119 2.7975985574585799931 3.8225413993912962241 0.71572403342214196975;-1.4598507538529073013 -3.3591044655017627818 3.2019874522462976607 2.2006693780507688984;3.0646294936634084216 2.2316850515080530748 1.4096517889898907416 -2.0467118714657455136;2.623231391167528237 1.7318479835442228687 1.5680427401604302151 3.3345575705061940575;2.3945305665126999095 2.8936288334342061823 -0.85216964305681131009 2.5853969996074419591;-2.4519783773106076374 -1.3418545957542762359 2.4447338799109012974 -3.5502268238215566321];

% Layer 2
b2 = 1.1269678009254981976;
LW2_1 = [0.71605404767398239674 -0.8992347016938743165 -0.80809100761337182561 1.2868808773345767893 0.16173745363248745455 0.71036224904946809744 1.4969941406238669313 0.39950681801637366597 1.271675218720989653 0.58507320572071241926 0.17052559889550858441 -0.033450070929335232184 -0.61127241817812427715 -0.71739431857881885701 -0.31233924075200836246 0.19025887316965592322 -0.97788224829256409354 -1.6467294728556443051 -0.092208367935344565103 -0.17246654524284282806 -1.1987558155452635589 -1.929480571355988161 0.80161946096442371346 0.84869375958990700415 0.77310268515665447886 0.05582879207901096652 0.28724557559999053247 0.86278369522481390685 -0.46780412321941555742 -0.19263572395927347491 -0.20234169273419075341 1.3994833184158228523 -0.76772715578724193275 -0.11691702701033479528 0.10300362306398316847 -0.53339889954705654862 0.28638161121219030125 0.31613916167597655438 0.71668306148032512315 -0.16753455241260067909 0.69580161727168021724 -0.48958439424133182172 0.77256009436076922281 0.89009323755901648134 0.91380500763748073734 -0.99125243600943835354 -0.13009190794470215646 0.2979533551664970692 0.066386666639803165735 0.51132101418219633171 -0.22317781983434761828 -0.44570689925445450275 -0.71516904454958207804 -0.48535604640681806465 0.070860531951082994517 -1.2497083824344863423 -1.270100921260777449 -0.015709280846265227111 0.44757823862322598796 0.23680895569833035341 -0.38404547713386999463 0.23862379453062393386 -0.68647312434338425557 0.37513200455782946818 0.088165469151113853852 0.75993174438892729938 -0.26988933113655150242 0.35792679215020578587 0.38516148197517291463 -1.0002775197116537953 0.27714091983814054254 0.16645957252791754311 0.29031647749535111069 0.40314572144474464244 0.90234056496015235815 0.91031449848884271603 -0.23976241699225514514 -0.40355855333539336627 0.86501004459758257248 -0.28639938818725196867 -0.66150432740003506371 -0.22704115103521166352 0.02301464243436111487 0.28295207433022556698 0.31283763101942996254 0.37340425978694186115 -0.33136393024611449087 0.064049703736138219323 -0.18075458076193223755 -0.6146778212874965952 1.2500084631918417788 -0.77501474168559891798 -0.016683255066108109571 0.27784712065732086739 0.90746989882988904341 0.44410733321828838038 0.15818198529093827065 -0.073017845276783288622 0.54001223469265280386 0.2350627500290732308 0.31888439573297494567 -0.11861490099247554153 0.048392675058113059083 0.50875749896978839093 0.17703171243153428827 0.30064939092091458317 0.62447751949213070599 0.35691674903264491991 -0.64794457191149446018 -1.0274749885489848911 -0.58024789737300930259 0.075346740603556172644 0.18900396483044348828 0.17104390774616554105 -0.15879379897067241734 0.096717068847751941352 -0.45008440864907661716 -0.21909502636247413232 -0.85330923365288824378 -0.99830534186967412325 -0.010500703324385608772 1.4472336759746162738 -0.70660355226531734729 -0.40790933680670632411 -0.69147372809850371489 0.15827237189901205427 0.20564672609468548359 -0.1156232041219346085 0.16517302330807104305 0.21338506501597523379 -0.44258760601150526348 -0.097511145659111883588 0.32334074843783722208 0.74367235829998135088 0.34489380829699106679 0.42674539305205394513 0.16552647211665103 -0.077770884324592420844 -0.15614086053993767034 0.13144147214630452769];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.862068965517241;
y1_step1.xoffset = 0;

% ===== SIMULATION ========

% Dimensions
Q = size(x1,2); % samples

% Input 1
xp1 = mapminmax_apply(x1,x1_step1);

% Layer 1
a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*xp1);

% Layer 2
a2 = repmat(b2,1,Q) + LW2_1*a1;

% Output 1
y1 = mapminmax_reverse(a2,y1_step1);
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
