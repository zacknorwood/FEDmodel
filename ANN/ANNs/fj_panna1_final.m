function [y1] = fj_panna1_final(x1)
%FJ_PANNA1_FINAL neural network simulation function.
%
% Auto-generated by MATLAB, 08-May-2019 13:05:13.
% 
% [y1] = fj_panna1_final(x1) takes these arguments:
%   x = 4xQ matrix, input #1
% With 
%   Row 1: Outdoor temperature in Celsius
%   Row 2: Month [1-12]
%   Row 3: Workday or non-workday [1 = workday, 0 = non-workday] 
%   Row 4: Time of day [1-24, with 24 = 00 is treated as the start of the
%          year, i.e., the first hour of the year has value 24. This since
%          the logged value for that time is primarly between 23 -24 the
%          day before]
% and returns:
%   y = 1xQ matrix, output #1
% where Q is the number of samples.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-11.5;1;0;1];
x1_step1.gain = [0.08;0.181818181818182;2;0.0869565217391304];
x1_step1.ymin = -1;

% Layer 1
b1 = [-3.9654766270072450141;4.4863558791733160191;4.2371042005227188554;3.7081380089160234093;-3.708538202983368226;-3.2890604818049062885;-4.1365772477356301806;3.2066569379050151589;2.6950652496897236077;2.5973394158285691979;-4.1283692723436047345;3.6375471760315787328;2.1128122321140345719;-3.9130606552194984182;-2.7514160866760390967;2.0237887397514633392;1.730188868928111523;-0.46156554044502218215;0.24810639324172700793;-2.6409712050523919125;-0.74112347243829213017;-0.56939065705250357929;3.10549947598678866;4.027520884895583464;1.1619671836423031142;-1.363723130298594155;-0.41655325482146027261;0.055233154202277263967;0.59607677534882730352;-0.03555871599568802971;-0.038099291740212037904;0.75255066502575818088;-0.74327862702144953388;0.28996187862788308509;-0.60214210736272522073;0.46183792981541327283;-0.73013374800739827553;-0.35802720153368411404;-2.7684565948521515644;-1.5630706516236732018;-2.2156925188422258444;-1.9796557355330171024;3.6703244380398261093;1.844159792413839094;3.7724282226747956059;-2.4369320586012395147;2.3776213572433246846;2.8291471673720263169;2.2656732230303076037;3.0241937779633385475;3.3855184518672993832;-3.3851468222180534084;-3.2897863437815169085;-3.2787483460342659036;-2.6778847739708080411;3.06581601996897124;-4.3446379968395829607;4.3702883900607902845;-3.8338974560702467897;4.2261657539559962515];
IW1_1 = [2.7407010417497743582 -0.69417698595459331745 -3.3114463513827456786 -0.34744888274565866038;-0.075050889268556617018 2.9123239068088455639 -2.2532882605615101035 2.6574935243734940649;-3.1733322089244544451 2.7778082916691402282 1.4215297515864655509 -1.9715845894226957657;-1.9992651919523025672 1.2795978872964475226 2.8167323353492204063 0.76124786379153219773;0.34140647231761961367 2.7618562573509879421 -2.7435456514882683443 2.5873954331280786256;4.4356912229473275389 0.75588394671886349752 -2.1493074535054059737 -1.381317642015398528;0.86459450204604726409 -0.35024619252728445007 2.2793022738757424683 -4.6693705689544220405;-2.0178589294363717954 4.0607733994853338899 -0.90475656107822466367 1.4744361506886298763;-1.8694397672407916389 -3.0591827796084576363 -1.8046817317591639096 -2.0707838831292235682;-2.7356456886109055127 -1.4475499196785757139 2.2622770558617966152 2.5737695171729537691;2.3305076990955142513 -2.77708822257942467 0.42896676040574238664 -4.1433055953067530197;-5.4738310223411410504 2.0077618311950380381 -2.4733025252821061457 2.6915375111804120678;-3.4752492637400966835 3.4036804576467210026 1.7285951715457219535 0.093337954154896513037;3.6017030449976465967 -2.2869097383457970274 2.8361149652406307808 0.75425499465304834956;1.0556604912471247992 -1.1520334388801265479 1.520252413755422527 3.5137884821400580115;-2.1418034003242074625 -2.3627657290278616387 0.050145587261221771791 2.088812826730994221;0.12687570623165894679 -2.7561033117106448209 -3.378733160516151468 0.48934879364724703787;2.2453531471044967383 1.8707985471495025553 -4.0781190240623166332 3.6771939593400428947;-0.59885530801129305267 1.6104657174849856816 0.085542418948838003234 2.5006224174294180429;1.8155796490735500726 -2.8595994535763185063 3.1978746385599108315 1.5086083069291162939;0.74017647573712352926 -0.28870053642004250838 3.8895778403803320522 -1.8443853261903944141;-0.94556980115794297959 3.2211741496833057319 -1.5470992451341021301 -4.1312849193435630113;-4.2048508959622532544 0.28012477749903907931 -3.7370776505447991234 -0.99553244584135858197;-7.2619343131659892521 -2.9730360612638757623 -4.8252889118663775392 -1.7878492430139236724;-4.7715199334511497753 -0.66825767179859996148 1.9522931014585691578 0.69261679135420117781;6.8280577078780355649 -3.1717848113211264405 -3.3606647449047444276 -0.42402670333856107288;-4.6304348570051780953 4.2439707482732416111 -1.8648858783578103893 -0.050617630641605883268;1.6633908785592312896 -2.2764713711851545241 -2.4921022206551937117 -2.5273821505588216496;-3.4554881845122551454 3.8421182094446946209 0.65235644331205533408 -2.3240630243227817786;4.1831787354069920326 3.0112959958055176557 3.283657534740120898 3.1743187049097980612;-2.6991651173341080217 -2.2694614498522924784 2.1127249914818437837 -0.38479021415567038478;3.2427566726164549493 -6.4350504474384555564 2.0510950329807395853 0.91262868669705965452;-1.6176141492586864068 -2.068038004484866299 -0.47251752836906152355 0.068803733095282523791;-2.6313702943924486277 -0.32414160278845044472 -1.4848097765262662229 3.4426225376360934938;-4.9644079200086732584 -2.8178646353427265758 3.3535878497412121568 0.51437900537196512563;2.8220906319964109699 1.2395737904708326038 1.7712550544587015722 2.4707112735068164078;-2.7773010010257572766 -0.77318372304851268328 -2.9004523357809319783 2.6259848982228803926;-1.254503927290793408 3.6669538519184672332 -2.5223251373960779986 1.2922855794133107921;-5.5199338853892223611 4.785770092375477347 1.2335514216791478859 1.4644488849293624266;-0.54355221782912266359 1.8341016602379853762 1.7071993780885881264 5.4341522863372802021;-1.2010658402668865641 -1.9937965989736745609 -3.1526541707298858519 1.892644310438049482;-2.3883533284174118805 -3.2123198987337402421 -2.4915813607914012451 -0.37395212877182398836;5.6164611382431086639 -0.95596546377256996774 -0.34224659514303334973 4.1205491016733084564;3.3352425491891763976 -1.138324910943545154 -2.6424161786344573244 -2.15003015856647961;3.8061059577522580177 -2.8126797503831300062 -1.1421222234821148955 -2.1524710407052438654;-1.4922125843856235416 -2.6309241394102711453 -2.1025770202054321345 -3.4663509608073916901;3.3768926921173365585 0.28204156995069445957 -2.9187387189002880206 -3.9706963537172765832;-0.88430426088634550563 -0.72598349971066988839 -1.015664948189880068 -3.7554707215794809194;0.85353792028900721256 -2.0130837512949710799 -3.6111948660400736699 -1.0033005231054734629;1.3739343178693737002 2.4315718002305986012 2.2598348991525121221 -3.9802056264456919799;2.8762412353930848496 -3.7196828273818161037 -1.5119099358083061269 -2.506815633424344103;-4.2066276069446990604 -0.3125243161427748162 1.4936796694126106555 3.4427636981220315349;-1.3628109422526086814 -1.4827843424363977842 1.9849478609879913638 -2.7316188880079264045;-2.7741375738497522363 0.040370961038161734535 -2.7064788986894523504 1.0568148157588401759;-1.4636849507027134276 2.3121621794591762367 2.7830652314683934634 -2.771735961132852033;4.2082104768078973933 -3.0156215547410107902 0.6997508869838672263 2.0531959880050982825;-4.2009994549443643308 3.6905278703202921697 -1.7133255902047945796 -1.7451869275970397499;0.65488538791800088301 3.3040857408187540578 -3.7512035644785250987 3.6882510980663605338;-0.6006476818486994329 -3.7190247632596320493 2.53004893233229744 0.83479602045547207645;2.5384780209870410062 -3.0375365094269435318 -2.0336011538289580081 1.7634411217476682054];

% Layer 2
b2 = -1.0495678197204392212;
LW2_1 = [-0.81538771648672969672 2.2863519050892517903 -0.18127938500906592978 -1.4493612840101719463 0.56404102103736741824 0.70480907795708103158 -0.34186350912380802924 0.63326274633685930571 -0.59075204893289734454 1.0472326532284368383 -0.39018593975114612693 -0.63833371791391346761 1.3281801269611064331 -1.2655624679767636387 0.56891154862768977818 0.96093397595817731105 1.0849566402228250084 -0.21829254523923408149 -0.59192962204148003025 -0.5608920470376981271 1.6608597593408038762 -0.26199601998796984148 -1.3822940802029002327 -0.51181332814879842985 -1.1140142274335622652 0.45378708581101900865 -0.5451000270360698563 0.46572112026178469346 -0.29060491250294001597 0.41517277628825777214 0.94853251254664328052 1.2044793230426438235 0.96048951296578000125 -0.83526959515373733201 -0.65930369518253617578 -0.37169704388534485773 0.91168427772370241868 0.6365323911442941629 0.61380566115586909781 -0.2776203027297567405 -1.6315198756206061859 -1.0345983826376194958 -0.18794621473063924388 -1.8855257778302831895 -0.70171660603550722879 -0.17817925150318500438 0.64608331592257661757 0.36058465389787958122 3.1494625415041119787 0.37565718444385420849 0.76378263154732406459 0.58160748746368307049 1.8247448764248928033 1.4945184333835852541 0.31554799280146761387 -0.50397796997421961951 -0.5008640371672663516 0.60361290910882947625 -0.91193121234502638739 -0.54166955965480401147];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.454545454545455;
y1_step1.xoffset = 2.6;

% ===== SIMULATION ========

% Dimensions
Q = size(x1,2); % samples

% Input 1
xp1 = mapminmax_apply(x1,x1_step1);

% Layer 1
a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*xp1);

% Layer 2
a2 = repmat(b2,1,Q) + LW2_1*a1;

% Output 1
y1 = mapminmax_reverse(a2,y1_step1);
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
