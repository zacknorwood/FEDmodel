function [y1] = fj_matte_final(x1)
%TESTTEST neural network simulation function.
%
% Auto-generated by MATLAB, 07-May-2019 10:38:43.
% 
% [y1] = testtest(x1) takes these arguments:
%   x = 4xQ matrix, input #1
% With 
%   Row 1: Outdoor temperature in Celsius
%   Row 2: Month [1-12]
%   Row 3: Workday or non-workday [1 = workday, 0 = non-workday] 
%   Row 4: Time of day [1-24, with 24 = 00 is treated as the start of the
%          year, i.e., the first hour of the year has value 24. This since
%          the logged value for that time is primarly between 23 -24 the
%          day before]
% and returns:
%   y = 1xQ matrix, output #1
% where Q is the number of samples.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-12.5;0;0;1];
x1_step1.gain = [0.0436681222707424;0.166666666666667;2;0.0869565217391304];
x1_step1.ymin = -1;

% Layer 1
b1 = [-2.1526233981997564548;3.3797045505746834415;2.960552831316817457;3.5642825664368005256;-2.9139584766334198918;3.3387561886884817852;-4.3529994458621397158;1.3723620379786938273;1.8850535603677689434;-2.4252405413012838586;2.9147271570659984974;1.9793136631944130421;-2.3177876096956273599;0.53228682726999942965;0.65934120233202986316;1.365091862354509189;-1.2466603657828385643;-1.40326584119539155;-0.38325789646054708726;-0.17043907163897020762;-0.853701300992279144;0.16617225905294916166;-0.84205524110932750137;-0.20882252251326940962;-0.96381542519380480893;-0.66479071087854324507;1.9384891669691795002;2.5367052659631412759;-2.1872273202716150386;-2.5333687637342712229;-1.4253948895705896849;3.4713067998497586508;2.8822162933284181108;2.2458111144120529445;-3.4179816369263562592;2.5789878664574366063;-5.524148906914339463;-4.7927734760356148769;-4.0806982156464588485;-2.3464477018970968381];
IW1_1 = [2.7073050570397820813 -2.1261247655049149152 -1.279744520052010559 1.4352097071836127373;-2.4820944833527569529 0.28901468304006022736 2.5111967576794254065 1.9668522972716768749;0.20068218023267503369 -0.10089481952397601205 -2.3002175796952442077 -3.7043753308952109826;-2.2412555005127865471 -0.10860746962741057997 -0.93567334215822717258 -3.5444340371096569875;0.24317017319212694271 2.8814168510603090922 -1.2055373270985088041 0.69198460221561031158;-3.0180275027154039869 -4.8116711426397520412 0.78851132379380617365 -0.20545538197424595417;0.22251336752042250033 1.4582975435243994422 -0.15227841271282419044 -2.0469343114536435735;-1.1353205189334649727 2.0642204694756554062 -0.29689141177005912153 -1.1209673114599147947;-1.6252606607445723164 -0.90383764123258569789 2.0563949587651864093 -1.7760965472711927049;0.79584458716006456491 -1.1557075596797334871 -2.1608931515618174934 -0.13029556288946433917;-3.6965412173638072524 -2.147700303892417395 -1.7768391654663098222 1.7064209962911018881;-1.9449867724643792322 -1.0830086247117487463 -2.1052225363716186024 -0.068170264947412198553;3.1550472137353735569 -1.3464856107690228448 -3.6015921912030415264 -0.10730028000970248669;-1.4748795903578673094 -2.5942481279626035118 2.1060496120228235917 -1.2534904216023237122;0.19463288279344684306 -1.1860324442833904968 -1.4659519589756604407 0.60100365451987569632;-0.43424598787470714001 -0.016248968334483873677 -3.3867422775153039893 -5.00880817738383044;2.7840958764325365316 0.6536096988977629918 2.2477798847380863201 -0.84470645252922116342;0.57698598925292399198 0.065393500364921822166 3.3238889415253103365 4.9664250598397154945;-1.0161094996616764075 -0.75333045544166632457 3.7251040396243921826 -1.3896967585502946196;-5.3226736549747242222 -1.1973835486058066468 2.8501964588322143968 4.5603534743190827783;2.5640908411700875646 2.3833572102571003448 -3.1505149293886924866 -0.051639229447722354016;-0.78282033690639607482 -0.17787451278772253849 -2.118391594341637596 3.8834517081538688643;-3.7391370200548870173 1.2932514218429762565 2.2398896995110848529 -0.099181450056917752622;0.15882294522108547641 -0.36572417291958492225 2.8141062430130467931 1.7697573418731782358;-1.2636956164613333264 0.020171560576733225251 0.19736012435159269729 1.9332965232152634627;-3.1173485960015776541 -2.3158317295911512446 0.090265627777079623928 -0.012218250140158105552;-1.1172205781938548963 -0.98691047407201970554 2.872223679654964279 0.28101105809126897261;2.6203968481047406058 0.64416523536424685759 0.95419286841307782154 -2.1590855490395712835;-0.80153421652248668661 4.8224610551937221459 0.23578416594474127521 0.11219894836406907324;-5.7451711756047316726 -0.54540222363064294608 -0.6356714826813527619 -2.6729403582034514386;-1.9020319950086042038 -0.82790181318375544173 1.5590082031119367745 -0.18496491240174384174;3.9096522986157573598 -3.2019433746526271278 -2.2438495558702604704 0.058474786340085377345;-0.74675272701602646297 -2.5892737967359606976 -0.51300009749387087687 -1.6326269380732572056;2.5897869068254100178 0.54218533825835490969 0.80698536369415718728 -1.6174438672981295007;-3.5056033550826457557 2.9836837039522658976 2.3863076659172062222 -0.066621869822679147255;1.4689134551518738814 -1.2984817451228150009 3.2556691316422727844 0.37582041327017801091;-3.2336235199450560351 -4.2218984904486962506 1.9685089910166864158 0.14958542040712319299;-4.2741226016209319383 0.013566697101546228849 -2.9136351822267356759 1.3995076998294246895;-1.6950562381631320008 0.99559313818473327284 2.0809774944480752268 -4.7273876330852697691;0.30124954541352827464 0.25732884733725230886 -0.71651277125264878354 -2.6813554385786275702];

% Layer 2
b2 = 2.4345809139431526802;
LW2_1 = [0.29633406065557843512 0.1900458238628095764 0.14550353278216657249 -0.089156178674220321057 -0.48198334344603743773 -0.16457557605433562053 -1.0894641719798376922 -0.42124819165903176765 0.22674219167848172485 1.6994932552468353659 0.11494344264237150999 -2.2648702567929013263 -0.34884394020197168063 -0.26691887568517408402 -1.4638088009977265891 -1.6297086887093357177 -0.23991433413772164651 -1.5362023251070910934 1.7702614975584827217 0.059578041605981527096 -1.2296517420891395211 -0.25012590975491305612 -0.23548176124448796931 -1.577223050307508645 0.63549977275310676195 0.81910852567327796514 -3.6376061821078971015 1.0585883112078429136 0.25939536517719291586 0.058992026153231270913 1.7096019451128543487 -0.9612799075208355859 0.28755459171985986444 -1.4508259693044442962 -1.2145494182516769488 -1.5721047621884447487 0.3266134621217046119 -0.18850508044123848173 0.05972406613159250699 -0.67071898335126589608];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 9.09090909090909;
y1_step1.xoffset = 0;

% ===== SIMULATION ========

% Dimensions
Q = size(x1,2); % samples

% Input 1
xp1 = mapminmax_apply(x1,x1_step1);

% Layer 1
a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*xp1);

% Layer 2
a2 = repmat(b2,1,Q) + LW2_1*a1;

% Output 1
y1 = mapminmax_reverse(a2,y1_step1);
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
